# üõ°Ô∏è Advanced IDOR Scanner

> **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–∫–∞–Ω–µ—Ä —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π IDOR (Insecure Direct Object Reference)** —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –≤—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫  
> –ü—Ä–æ–µ–∫—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∞–Ω –≤ —Ä–∞–º–∫–∞—Ö –æ–ª–∏–º–ø–∏–∞–¥—ã –ø–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–∫–µ –∏ –≤–∫–ª—é—á–∞–µ—Ç —Ç—Ä–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º—ã—Ö –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –¥–ª—è –≤—Å–µ—Å—Ç–æ—Ä–æ–Ω–Ω–µ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

![.NET](https://img.shields.io/badge/.NET-6%2B-512BD4?logo=.net&logoColor=white)
![C#](https://img.shields.io/badge/C%23-10-239120?logo=c-sharp&logoColor=white)
![License](https://img.shields.io/badge/License-MIT-blue)
![Platform](https://img.shields.io/badge/Platform-Cross--platform-lightgrey)

---

## üìå –û –ø—Ä–æ–µ–∫—Ç–µ

**IDOR (Insecure Direct Object Reference)** ‚Äî –æ–¥–Ω–∞ –∏–∑ —Å–∞–º—ã—Ö –æ–ø–∞—Å–Ω—ã—Ö –∏ —á–∞—Å—Ç–æ –≤—Å—Ç—Ä–µ—á–∞—é—â–∏—Ö—Å—è —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –≤ –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö –∏ API. –ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –∫–∞–∂—É—â—É—é—Å—è –ø—Ä–æ—Å—Ç–æ—Ç—É, –µ—ë –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è **—Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ—Ö–Ω–∏–∫**, –≤—ã—Ö–æ–¥—è—â–∏—Ö –∑–∞ —Ä–∞–º–∫–∏ –ø—Ä–æ—Å—Ç–æ–π –ø–æ–¥—Å—Ç–∞–Ω–æ–≤–∫–∏ ID.

–≠—Ç–æ—Ç –ø—Ä–æ–µ–∫—Ç –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π, –∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π —Å–∫–∞–Ω–µ—Ä –Ω–∞ C#**, —Ä–µ–∞–ª–∏–∑—É—é—â–∏–π:

- ‚úÖ Parameter Pollution  
- ‚úÖ JSON Globbing  
- ‚úÖ HTTP Method Bypass  
- ‚úÖ Content-Type Manipulation  
- ‚úÖ API Version Testing  
- ‚úÖ Second-Order (Store-and-Leak) IDOR  

–°–∫–∞–Ω–µ—Ä —Å–æ–ø—Ä–æ–≤–æ–∂–¥–∞–µ—Ç—Å—è **—Ç—Ä–µ–º—è —É—è–∑–≤–∏–º—ã–º–∏ —Å–∞–π—Ç–∞–º–∏**, —Å–æ–∑–¥–∞–Ω–Ω—ã–º–∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –∫–∞–∂–¥–æ–π –∏–∑ —Ç–µ—Ö–Ω–∏–∫ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞.

---

## üéØ –¶–µ–ª—å

–°–æ–∑–¥–∞—Ç—å **–±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ, –æ—Ç–∫—Ä—ã—Ç–æ–µ, —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ**, –∫–æ—Ç–æ—Ä–æ–µ:

- –ù–∞—Ö–æ–¥–∏—Ç **advanced IDOR-—É—è–∑–≤–∏–º–æ—Å—Ç–∏**, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã–µ –¥–ª—è Burp Suite / OWASP ZAP –±–µ–∑ —Ä—É—á–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏  
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **–æ–±—É—á–µ–Ω–∏—è, –ø–µ–Ω—Ç–µ—Å—Ç–∞ –∏ CI/CD-–∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏**  
- –í—ã–ø–æ–ª–Ω—è–µ—Ç —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è –æ–ª–∏–º–ø–∏–∞–¥—ã: —Ä–µ—à–µ–Ω–∏–µ –∞–∫—Ç—É–∞–ª—å–Ω–æ–π, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω–Ω–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫–∞–º–∏ –ø—Ä–æ–±–ª–µ–º—ã  

---

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

| –§—É–Ω–∫—Ü–∏—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|--------|---------|
| üß™ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è >50 URL-–∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ç–∏–ø–æ–≤—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ |
| ‚öôÔ∏è –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–µ—Ö–Ω–∏–∫ IDOR | –í–∫–ª—é—á–∞—è second-order –∏ JSON globbing |
| üì§ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ | PDF (—Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π —Ä–∏—Å–∫–∞), JSON, CSV |
| üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ cookies –∏ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∑–∞–≥–æ–ª–æ–≤–∫–æ–≤ |
| üñ•Ô∏è –ö–æ–Ω—Å–æ–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å | –ö—Ä–∞—Å–∏–≤—ã–π CLI —á–µ—Ä–µ–∑ Spectre.Console |
| üß™ –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ —É—è–∑–≤–∏–º—ã–µ —Å–∞–π—Ç—ã | 3 ASP.NET Core –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å —Ä–∞–∑–Ω—ã–º–∏ –≤–µ–∫—Ç–æ—Ä–∞–º–∏ –∞—Ç–∞–∫–∏ |

---

## üß™ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –ü—Ä–∏–º–µ—Ä 1: –ë–∞–∑–æ–≤—ã–π IDOR + API versioning
```bash
dotnet run -- https://localhost:7185 -c "auth=apiuser1_token" -a
```
> –ù–∞–π–¥–µ–Ω–∞ —É—è–∑–≤–∏–º–æ—Å—Ç—å: `POST /api/v2/profiles/2` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

### –ü—Ä–∏–º–µ—Ä 2: Second-Order IDOR
> –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ ‚Üí —Å–∫–∞–Ω–µ—Ä –æ–±–Ω–∞—Ä—É–∂–∏–≤–∞–µ—Ç, —á—Ç–æ `GET /schedules/export/result/2` —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –¥—Ä—É–≥–æ–≥–æ.

### –ü—Ä–∏–º–µ—Ä 3: JSON Globbing
> –ó–∞–ø—Ä–æ—Å `{"user": {"*": "value"}}` –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ —Ä–∞—Å–∫—Ä—ã—Ç–∏—é –ø–æ–ª–µ–π, –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã—Ö –æ–±—ã—á–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

> ‚úÖ –í—Å–µ —Ç–µ—Ö–Ω–∏–∫–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ –≤–µ—Ä–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã.

---

## üõ†Ô∏è –¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **–Ø–∑—ã–∫**: C# 10  
- **–ü–ª–∞—Ç—Ñ–æ—Ä–º–∞**: .NET 6 (–∫—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω—ã–π)  
- **CLI**: Spectre.Console  
- **PDF-–æ—Ç—á—ë—Ç—ã**: iText 7  
- **–£—è–∑–≤–∏–º—ã–µ —Å–∞–π—Ç—ã**: ASP.NET Core MVC + Entity Framework Core (SQLite)  
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –ß–∏—Å—Ç—ã–π, –º–æ–¥—É–ª—å–Ω—ã–π –∫–æ–¥ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è  

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫

### 1. –°–±–æ—Ä–∫–∞ —Å–∫–∞–Ω–µ—Ä–∞
```bash
cd IdorAnalizerApplication
dotnet build
```

### 2. –ó–∞–ø—É—Å–∫ —É—è–∑–≤–∏–º—ã—Ö —Å–∞–π—Ç–æ–≤
```bash
cd VulnerableSites/Site1 && dotnet run
cd ../Site2 && dotnet run
cd ../Site3 && dotnet run
```

### 3. –°–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
dotnet run -- https://localhost:7185 -c "auth=YOUR_COOKIE" --advanced --threads 5
```

–§–ª–∞–≥–∏:
- `-a` / `--advanced` ‚Äî –≤–∫–ª—é—á–∏—Ç—å –≤—Å–µ —Ç–µ—Ö–Ω–∏–∫–∏  
- `-c` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å cookies  
- `--threads` ‚Äî –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤  

---

## üìÑ –û—Ç—á—ë—Ç—ã

–ü–æ—Å–ª–µ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è:
- `report.json`
- `report.csv`
- `report.pdf` ‚Äî —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π:  
  üî¥ **–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è** ‚Äî –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞–Ω–Ω—ã–º  
  üü† **–°—Ä–µ–¥–Ω—è—è** ‚Äî –∫–æ—Å–≤–µ–Ω–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏  
  üü¢ **–ù–µ—Ç —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π**

---

## üéì –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –æ–ª–∏–º–ø–∏–∞–¥–Ω—ã–º –∫—Ä–∏—Ç–µ—Ä–∏—è–º

- ‚úîÔ∏è –ê–∫—Ç—É–∞–ª—å–Ω–æ—Å—Ç—å (–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ H1 2025, OWASP, –§–ó-152)  
- ‚úîÔ∏è –°–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è (C#, .NET 6)  
- ‚úîÔ∏è –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö —É—è–∑–≤–∏–º—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è—Ö  
- ‚úîÔ∏è –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç—á—ë—Ç–æ–≤ –≤ —Ñ–æ—Ä–º–∞—Ç–∞—Ö, –≤–∫–ª—é—á–∞—è PDF –ø–æ –ì–û–°–¢  
- ‚úîÔ∏è –ê–Ω–∞–ª–∏–∑ –∞–Ω–∞–ª–æ–≥–æ–≤ –∏ –æ–±–æ—Å–Ω–æ–≤–∞–Ω–∏–µ —É–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç–∏ —Ä–µ—à–µ–Ω–∏—è  

---

> üîê **–í–∞–∂–Ω–æ**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç **—Ç–æ–ª—å–∫–æ –≤ —Ä–∞–º–∫–∞—Ö —ç—Ç–∏—á–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è** –∏ —Å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –≤–ª–∞–¥–µ–ª—å—Ü–∞ —Å–∏—Å—Ç–µ–º—ã.

---
